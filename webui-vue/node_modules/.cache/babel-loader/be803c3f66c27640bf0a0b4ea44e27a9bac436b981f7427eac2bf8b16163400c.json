{"ast":null,"code":"import { createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, openBlock as _openBlock, createBlock as _createBlock, createElementBlock as _createElementBlock, createTextVNode as _createTextVNode, resolveDirective as _resolveDirective, withDirectives as _withDirectives } from \"vue\";\nconst _hoisted_1 = {\n  class: \"font-weight-bold m-0\"\n};\nconst _hoisted_2 = {\n  class: \"mb-0\"\n};\nconst _hoisted_3 = {\n  class: \"mb-0\"\n};\nconst _hoisted_4 = {\n  class: \"font-weight-bold m-0\"\n};\nconst _hoisted_5 = {\n  key: 1,\n  class: \"sr-only\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_b_card = _resolveComponent(\"b-card\");\n  const _component_status_icon = _resolveComponent(\"status-icon\");\n  const _component_icon_switch = _resolveComponent(\"icon-switch\");\n  const _component_b_btn = _resolveComponent(\"b-btn\");\n  const _component_b_card_group = _resolveComponent(\"b-card-group\");\n  const _component_page_section = _resolveComponent(\"page-section\");\n  const _component_modal_switch_to_running = _resolveComponent(\"modal-switch-to-running\");\n  const _directive_b_modal = _resolveDirective(\"b-modal\");\n  return _openBlock(), _createElementBlock(\"div\", null, [_createVNode(_component_page_section, {\n    \"section-title\": $options.sectionTitle\n  }, {\n    default: _withCtx(() => [_createVNode(_component_b_card_group, {\n      deck: \"\"\n    }, {\n      default: _withCtx(() => [_createCommentVNode(\" Running image \"), _createVNode(_component_b_card, null, {\n        header: _withCtx(() => [_createElementVNode(\"p\", _hoisted_1, _toDisplayString($data.$t('pageFirmware.cardTitleRunning')), 1 /* TEXT */)]),\n        default: _withCtx(() => [_createElementVNode(\"dl\", _hoisted_2, [_createElementVNode(\"dt\", null, _toDisplayString($data.$t('pageFirmware.cardBodyVersion')), 1 /* TEXT */), _createElementVNode(\"dd\", _hoisted_3, _toDisplayString($options.runningVersion), 1 /* TEXT */)])], undefined, true),\n        _: 1 /* STABLE */\n      }), _createCommentVNode(\" Backup image \"), _createVNode(_component_b_card, null, {\n        header: _withCtx(() => [_createElementVNode(\"p\", _hoisted_4, _toDisplayString($data.$t('pageFirmware.cardTitleBackup')), 1 /* TEXT */)]),\n        default: _withCtx(() => [_createElementVNode(\"dl\", null, [_createElementVNode(\"dt\", null, _toDisplayString($data.$t('pageFirmware.cardBodyVersion')), 1 /* TEXT */), _createElementVNode(\"dd\", null, [$options.showBackupImageStatus ? (_openBlock(), _createBlock(_component_status_icon, {\n          key: 0,\n          status: \"danger\"\n        })) : _createCommentVNode(\"v-if\", true), $options.showBackupImageStatus ? (_openBlock(), _createElementBlock(\"span\", _hoisted_5, _toDisplayString($options.backupStatus), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true), _createTextVNode(\" \" + _toDisplayString($options.backupVersion), 1 /* TEXT */)])]), !$data.switchToBackupImageDisabled ? _withDirectives((_openBlock(), _createBlock(_component_b_btn, {\n          key: 0,\n          \"data-test-id\": \"firmware-button-switchToRunning\",\n          variant: \"link\",\n          size: \"sm\",\n          class: \"py-0 px-1 mt-2\",\n          disabled: $props.isPageDisabled || !$options.backup || !$props.isServerOff\n        }, {\n          default: _withCtx(() => [_createVNode(_component_icon_switch, {\n            class: \"d-none d-sm-inline-block\"\n          }), _createTextVNode(\" \" + _toDisplayString($data.$t('pageFirmware.cardActionSwitchToRunning')), 1 /* TEXT */)], undefined, true),\n          _: 1 /* STABLE */\n        }, 8 /* PROPS */, [\"disabled\"])), [[_directive_b_modal, void 0, void 0, {\n          \"modal-switch-to-running\": true\n        }]]) : _createCommentVNode(\"v-if\", true)], undefined, true),\n        _: 1 /* STABLE */\n      })], undefined, true),\n      _: 1 /* STABLE */\n    })], undefined, true),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"section-title\"]), _createVNode(_component_modal_switch_to_running, {\n    backup: $options.backupVersion,\n    onOk: $options.switchToRunning\n  }, null, 8 /* PROPS */, [\"backup\", \"onOk\"])]);\n}","map":{"version":3,"names":["class","key","_createElementBlock","_createVNode","_component_page_section","$options","sectionTitle","default","_withCtx","_component_b_card_group","deck","_createCommentVNode","_component_b_card","header","_createElementVNode","_hoisted_1","_toDisplayString","$data","$t","_hoisted_2","_hoisted_3","runningVersion","_","_hoisted_4","showBackupImageStatus","_createBlock","_component_status_icon","status","_hoisted_5","backupStatus","_createTextVNode","backupVersion","switchToBackupImageDisabled","_component_b_btn","variant","size","disabled","$props","isPageDisabled","backup","isServerOff","_component_icon_switch","_component_modal_switch_to_running","onOk","switchToRunning"],"sources":["/home/zenchenko/openbmc/build/evb-ast2500/workspace/sources/webui-vue/src/views/Operations/Firmware/FirmwareCardsBmc.vue"],"sourcesContent":["<template>\n  <div>\n    <page-section :section-title=\"sectionTitle\">\n      <b-card-group deck>\n        <!-- Running image -->\n        <b-card>\n          <template #header>\n            <p class=\"font-weight-bold m-0\">\n              {{ $t('pageFirmware.cardTitleRunning') }}\n            </p>\n          </template>\n          <dl class=\"mb-0\">\n            <dt>{{ $t('pageFirmware.cardBodyVersion') }}</dt>\n            <dd class=\"mb-0\">{{ runningVersion }}</dd>\n          </dl>\n        </b-card>\n\n        <!-- Backup image -->\n        <b-card>\n          <template #header>\n            <p class=\"font-weight-bold m-0\">\n              {{ $t('pageFirmware.cardTitleBackup') }}\n            </p>\n          </template>\n          <dl>\n            <dt>{{ $t('pageFirmware.cardBodyVersion') }}</dt>\n            <dd>\n              <status-icon v-if=\"showBackupImageStatus\" status=\"danger\" />\n              <span v-if=\"showBackupImageStatus\" class=\"sr-only\">\n                {{ backupStatus }}\n              </span>\n              {{ backupVersion }}\n            </dd>\n          </dl>\n          <b-btn\n            v-if=\"!switchToBackupImageDisabled\"\n            v-b-modal.modal-switch-to-running\n            data-test-id=\"firmware-button-switchToRunning\"\n            variant=\"link\"\n            size=\"sm\"\n            class=\"py-0 px-1 mt-2\"\n            :disabled=\"isPageDisabled || !backup || !isServerOff\"\n          >\n            <icon-switch class=\"d-none d-sm-inline-block\" />\n            {{ $t('pageFirmware.cardActionSwitchToRunning') }}\n          </b-btn>\n        </b-card>\n      </b-card-group>\n    </page-section>\n    <modal-switch-to-running :backup=\"backupVersion\" @ok=\"switchToRunning\" />\n  </div>\n</template>\n\n<script>\nimport IconSwitch from '@carbon/icons-vue/es/arrows--horizontal/20';\nimport PageSection from '@/components/Global/PageSection';\nimport LoadingBarMixin, { loading } from '@/components/Mixins/LoadingBarMixin';\nimport BVToastMixin from '@/components/Mixins/BVToastMixin';\n\nimport ModalSwitchToRunning from './FirmwareModalSwitchToRunning';\nimport { useI18n } from 'vue-i18n';\nimport i18n from '@/i18n';\n\nexport default {\n  components: { IconSwitch, ModalSwitchToRunning, PageSection },\n  mixins: [BVToastMixin, LoadingBarMixin],\n  props: {\n    isPageDisabled: {\n      required: true,\n      type: Boolean,\n      default: false,\n    },\n    isServerOff: {\n      required: true,\n      type: Boolean,\n      default: false,\n    },\n  },\n  data() {\n    return {\n      $t: useI18n().t,\n      loading,\n      switchToBackupImageDisabled:\n        process.env.VUE_APP_SWITCH_TO_BACKUP_IMAGE_DISABLED === 'true',\n    };\n  },\n  computed: {\n    isSingleFileUploadEnabled() {\n      return this.$store.getters['firmware/isSingleFileUploadEnabled'];\n    },\n    sectionTitle() {\n      if (this.isSingleFileUploadEnabled) {\n        return i18n.global.t('pageFirmware.sectionTitleBmcCardsCombined');\n      }\n      return i18n.global.t('pageFirmware.sectionTitleBmcCards');\n    },\n    running() {\n      return this.$store.getters['firmware/activeBmcFirmware'];\n    },\n    backup() {\n      return this.$store.getters['firmware/backupBmcFirmware'];\n    },\n    runningVersion() {\n      return this.running?.version || '--';\n    },\n    backupVersion() {\n      return this.backup?.version || '--';\n    },\n    backupStatus() {\n      return this.backup?.status || null;\n    },\n    showBackupImageStatus() {\n      return (\n        this.backupStatus === 'Critical' || this.backupStatus === 'Warning'\n      );\n    },\n  },\n  methods: {\n    switchToRunning() {\n      this.startLoader();\n      const timerId = setTimeout(() => {\n        this.endLoader();\n        this.infoToast(\n          i18n.global.t('pageFirmware.toast.verifySwitchMessage'),\n          {\n            title: i18n.global.t('pageFirmware.toast.verifySwitch'),\n            refreshAction: true,\n          },\n        );\n      }, 60000);\n\n      this.$store\n        .dispatch('firmware/switchBmcFirmwareAndReboot')\n        .then(() =>\n          this.infoToast(\n            i18n.global.t('pageFirmware.toast.rebootStartedMessage'),\n            {\n              title: i18n.global.t('pageFirmware.toast.rebootStarted'),\n            },\n          ),\n        )\n        .catch(({ message }) => {\n          this.errorToast(message);\n          clearTimeout(timerId);\n          this.endLoader();\n        });\n    },\n  },\n};\n</script>\n"],"mappings":";;EAOeA,KAAK,EAAC;AAAsB;;EAI7BA,KAAK,EAAC;AAAM;;EAEVA,KAAK,EAAC;AAAM;;EAObA,KAAK,EAAC;AAAsB;;EApB3CC,GAAA;EA4BiDD,KAAK,EAAC;;;;;;;;;;;uBA3BrDE,mBAAA,CAiDM,cAhDJC,YAAA,CA8CeC,uBAAA;IA9CA,eAAa,EAAEC,QAAA,CAAAC;EAAY;IAF9CC,OAAA,EAAAC,QAAA,CAGM,MA4Ce,CA5CfL,YAAA,CA4CeM,uBAAA;MA5CDC,IAAI,EAAJ;IAAI;MAHxBH,OAAA,EAAAC,QAAA,CAIQ,MAAsB,CAAtBG,mBAAA,mBAAsB,EACtBR,YAAA,CAUSS,iBAAA;QATIC,MAAM,EAAAL,QAAA,CACf,MAEI,CAFJM,mBAAA,CAEI,KAFJC,UAEI,EAAAC,gBAAA,CADCC,KAAA,CAAAC,EAAE,kD;QARnBX,OAAA,EAAAC,QAAA,CAWU,MAGK,CAHLM,mBAAA,CAGK,MAHLK,UAGK,GAFHL,mBAAA,CAAiD,YAAAE,gBAAA,CAA1CC,KAAA,CAAAC,EAAE,kDACTJ,mBAAA,CAA0C,MAA1CM,UAA0C,EAAAJ,gBAAA,CAAtBX,QAAA,CAAAgB,cAAc,iB;QAb9CC,CAAA;UAiBQX,mBAAA,kBAAqB,EACrBR,YAAA,CA4BSS,iBAAA;QA3BIC,MAAM,EAAAL,QAAA,CACf,MAEI,CAFJM,mBAAA,CAEI,KAFJS,UAEI,EAAAP,gBAAA,CADCC,KAAA,CAAAC,EAAE,iD;QArBnBX,OAAA,EAAAC,QAAA,CAwBU,MASK,CATLM,mBAAA,CASK,aARHA,mBAAA,CAAiD,YAAAE,gBAAA,CAA1CC,KAAA,CAAAC,EAAE,kDACTJ,mBAAA,CAMK,aALgBT,QAAA,CAAAmB,qBAAqB,I,cAAxCC,YAAA,CAA4DC,sBAAA;UA3B1EzB,GAAA;UA2BwD0B,MAAM,EAAC;cA3B/DhB,mBAAA,gBA4B0BN,QAAA,CAAAmB,qBAAqB,I,cAAjCtB,mBAAA,CAEO,QAFP0B,UAEO,EAAAZ,gBAAA,CADFX,QAAA,CAAAwB,YAAY,oBA7B/BlB,mBAAA,gBAAAmB,gBAAA,CA8BqB,GACP,GAAAd,gBAAA,CAAGX,QAAA,CAAA0B,aAAa,iB,MAIXd,KAAA,CAAAe,2BAA2B,G,+BADpCP,YAAA,CAWQQ,gBAAA;UA7ClBhC,GAAA;UAqCY,cAAY,EAAC,iCAAiC;UAC9CiC,OAAO,EAAC,MAAM;UACdC,IAAI,EAAC,IAAI;UACTnC,KAAK,EAAC,gBAAgB;UACrBoC,QAAQ,EAAEC,MAAA,CAAAC,cAAc,KAAKjC,QAAA,CAAAkC,MAAM,KAAKF,MAAA,CAAAG;;UAzCrDjC,OAAA,EAAAC,QAAA,CA2CY,MAAgD,CAAhDL,YAAA,CAAgDsC,sBAAA;YAAnCzC,KAAK,EAAC;UAA0B,IA3CzD8B,gBAAA,CA2C4D,GAChD,GAAAd,gBAAA,CAAGC,KAAA,CAAAC,EAAE,2D;UA5CjBI,CAAA;;UAAA,2BAoCY;QAAiC,E,KApC7CX,mBAAA,e;QAAAW,CAAA;;MAAAA,CAAA;;IAAAA,CAAA;wCAiDInB,YAAA,CAAyEuC,kCAAA;IAA/CH,MAAM,EAAElC,QAAA,CAAA0B,aAAa;IAAGY,IAAE,EAAEtC,QAAA,CAAAuC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}