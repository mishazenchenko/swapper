{"ast":null,"code":"import VuelidateMixin from '@/components/Mixins/VuelidateMixin.js';\nimport { useVuelidate } from '@vuelidate/core';\nimport { useI18n } from 'vue-i18n';\nimport { required, requiredIf, minValue, maxValue } from '@vuelidate/validators';\nexport default {\n  mixins: [VuelidateMixin],\n  props: {\n    settings: {\n      type: Object,\n      required: true\n    }\n  },\n  setup() {\n    return {\n      v$: useVuelidate()\n    };\n  },\n  data() {\n    return {\n      $t: useI18n().t,\n      form: {\n        lockoutThreshold: 0,\n        unlockMethod: 0,\n        lockoutDuration: null\n      }\n    };\n  },\n  watch: {\n    settings: function ({\n      lockoutThreshold,\n      lockoutDuration\n    }) {\n      this.form.lockoutThreshold = lockoutThreshold;\n      this.form.unlockMethod = lockoutDuration ? 1 : 0;\n      this.form.lockoutDuration = lockoutDuration ? lockoutDuration : null;\n    }\n  },\n  validations: {\n    form: {\n      lockoutThreshold: {\n        minValue: minValue(0),\n        maxValue: maxValue(65535),\n        required\n      },\n      unlockMethod: {\n        required\n      },\n      lockoutDuration: {\n        minValue: function (value) {\n          return this.form.unlockMethod === 0 || value > 0;\n        },\n        required: requiredIf(function () {\n          return this.form.unlockMethod === 1;\n        })\n      }\n    }\n  },\n  methods: {\n    handleSubmit() {\n      this.v$.$touch();\n      if (this.v$.$invalid) return;\n      let lockoutThreshold;\n      let lockoutDuration;\n      if (this.v$.form.lockoutThreshold.$dirty) {\n        lockoutThreshold = this.form.lockoutThreshold;\n      }\n      if (this.v$.form.unlockMethod.$dirty) {\n        lockoutDuration = this.form.unlockMethod ? parseInt(this.form.lockoutDuration) : 0;\n      }\n      this.$emit('ok', {\n        lockoutThreshold,\n        lockoutDuration\n      });\n      this.closeModal();\n    },\n    onOk(bvModalEvt) {\n      // prevent modal close\n      bvModalEvt.preventDefault();\n      this.handleSubmit();\n    },\n    closeModal() {\n      this.$nextTick(() => {\n        this.$refs.modal.hide();\n      });\n    },\n    resetForm() {\n      // Reset form models\n      this.form.lockoutThreshold = this.settings.lockoutThreshold;\n      this.form.unlockMethod = this.settings.lockoutDuration ? 1 : 0;\n      this.form.lockoutDuration = this.settings.lockoutDuration ? this.settings.lockoutDuration : null;\n      this.v$.$reset(); // clear validations\n    }\n  }\n};","map":{"version":3,"names":["VuelidateMixin","useVuelidate","useI18n","required","requiredIf","minValue","maxValue","mixins","props","settings","type","Object","setup","v$","data","$t","t","form","lockoutThreshold","unlockMethod","lockoutDuration","watch","validations","value","methods","handleSubmit","$touch","$invalid","$dirty","parseInt","$emit","closeModal","onOk","bvModalEvt","preventDefault","$nextTick","$refs","modal","hide","resetForm","$reset"],"sources":["/home/zenchenko/openbmc/build/evb-ast2500/workspace/sources/webui-vue/src/views/SecurityAndAccess/UserManagement/ModalSettings.vue"],"sourcesContent":["<template>\n  <b-modal\n    id=\"modal-settings\"\n    ref=\"modal\"\n    :title=\"$t('pageUserManagement.accountPolicySettings')\"\n    @hidden=\"resetForm\"\n  >\n    <b-form id=\"form-settings\" novalidate @submit.prevent=\"handleSubmit\">\n      <b-container>\n        <b-row>\n          <b-col>\n            <b-form-group\n              :label=\"$t('pageUserManagement.modal.maxFailedLoginAttempts')\"\n              label-for=\"lockout-threshold\"\n            >\n              <b-form-text id=\"lockout-threshold-help-block\">\n                {{\n                  $t('global.form.valueMustBeBetween', {\n                    min: 0,\n                    max: 65535,\n                  })\n                }}\n              </b-form-text>\n              <b-form-input\n                id=\"lockout-threshold\"\n                v-model.number=\"form.lockoutThreshold\"\n                type=\"number\"\n                aria-describedby=\"lockout-threshold-help-block\"\n                data-test-id=\"userManagement-input-lockoutThreshold\"\n                :state=\"getValidationState(v$.form.lockoutThreshold)\"\n                @input=\"v$.form.lockoutThreshold.$touch()\"\n              />\n              <b-form-invalid-feedback role=\"alert\">\n                <template v-if=\"v$.form.lockoutThreshold.required.$invalid\">\n                  {{ $t('global.form.fieldRequired') }}\n                </template>\n                <template\n                  v-else-if=\"\n                    !v$.form.lockoutThreshold.minLength ||\n                    !v$.form.lockoutThreshold.maxLength\n                  \"\n                >\n                  {{\n                    $t('global.form.valueMustBeBetween', {\n                      min: 0,\n                      max: 65535,\n                    })\n                  }}\n                </template>\n              </b-form-invalid-feedback>\n            </b-form-group>\n          </b-col>\n          <b-col>\n            <b-form-group\n              :label=\"$t('pageUserManagement.modal.userUnlockMethod')\"\n            >\n              <b-form-radio\n                v-model=\"form.unlockMethod\"\n                name=\"unlock-method\"\n                class=\"mb-2\"\n                :value=\"0\"\n                data-test-id=\"userManagement-radio-manualUnlock\"\n                @input=\"v$.form.unlockMethod.$touch()\"\n              >\n                {{ $t('pageUserManagement.modal.manual') }}\n              </b-form-radio>\n              <b-form-radio\n                v-model=\"form.unlockMethod\"\n                name=\"unlock-method\"\n                :value=\"1\"\n                data-test-id=\"userManagement-radio-automaticUnlock\"\n                @input=\"v$.form.unlockMethod.$touch()\"\n              >\n                {{ $t('pageUserManagement.modal.automaticAfterTimeout') }}\n              </b-form-radio>\n              <div class=\"mt-3 ml-4\">\n                <b-form-text id=\"lockout-duration-help-block\">\n                  {{ $t('pageUserManagement.modal.timeoutDurationSeconds') }}\n                </b-form-text>\n                <b-form-input\n                  v-model.number=\"form.lockoutDuration\"\n                  aria-describedby=\"lockout-duration-help-block\"\n                  type=\"number\"\n                  data-test-id=\"userManagement-input-lockoutDuration\"\n                  :state=\"getValidationState(v$.form.lockoutDuration)\"\n                  :readonly=\"v$.form.unlockMethod.$model === 0\"\n                  @input=\"v$.form.lockoutDuration.$touch()\"\n                />\n                <b-form-invalid-feedback role=\"alert\">\n                  <template v-if=\"v$.form.lockoutDuration.required.$invalid\">\n                    {{ $t('global.form.fieldRequired') }}\n                  </template>\n                  <template v-else-if=\"!v$.form.lockoutDuration.minvalue\">\n                    {{ $t('global.form.mustBeAtLeast', { value: 1 }) }}\n                  </template>\n                </b-form-invalid-feedback>\n              </div>\n            </b-form-group>\n          </b-col>\n        </b-row>\n      </b-container>\n    </b-form>\n    <template #modal-footer=\"{ cancel }\">\n      <b-button\n        variant=\"secondary\"\n        data-test-id=\"userManagement-button-cancel\"\n        @click=\"cancel()\"\n      >\n        {{ $t('global.action.cancel') }}\n      </b-button>\n      <b-button\n        form=\"form-settings\"\n        type=\"submit\"\n        variant=\"primary\"\n        data-test-id=\"userManagement-button-submit\"\n        @click=\"onOk\"\n      >\n        {{ $t('global.action.save') }}\n      </b-button>\n    </template>\n  </b-modal>\n</template>\n\n<script>\nimport VuelidateMixin from '@/components/Mixins/VuelidateMixin.js';\nimport { useVuelidate } from '@vuelidate/core';\nimport { useI18n } from 'vue-i18n';\n\nimport {\n  required,\n  requiredIf,\n  minValue,\n  maxValue,\n} from '@vuelidate/validators';\n\nexport default {\n  mixins: [VuelidateMixin],\n  props: {\n    settings: {\n      type: Object,\n      required: true,\n    },\n  },\n  setup() {\n    return {\n      v$: useVuelidate(),\n    };\n  },\n  data() {\n    return {\n      $t: useI18n().t,\n      form: {\n        lockoutThreshold: 0,\n        unlockMethod: 0,\n        lockoutDuration: null,\n      },\n    };\n  },\n  watch: {\n    settings: function ({ lockoutThreshold, lockoutDuration }) {\n      this.form.lockoutThreshold = lockoutThreshold;\n      this.form.unlockMethod = lockoutDuration ? 1 : 0;\n      this.form.lockoutDuration = lockoutDuration ? lockoutDuration : null;\n    },\n  },\n  validations: {\n    form: {\n      lockoutThreshold: {\n        minValue: minValue(0),\n        maxValue: maxValue(65535),\n        required,\n      },\n      unlockMethod: { required },\n      lockoutDuration: {\n        minValue: function (value) {\n          return this.form.unlockMethod === 0 || value > 0;\n        },\n        required: requiredIf(function () {\n          return this.form.unlockMethod === 1;\n        }),\n      },\n    },\n  },\n  methods: {\n    handleSubmit() {\n      this.v$.$touch();\n      if (this.v$.$invalid) return;\n\n      let lockoutThreshold;\n      let lockoutDuration;\n      if (this.v$.form.lockoutThreshold.$dirty) {\n        lockoutThreshold = this.form.lockoutThreshold;\n      }\n      if (this.v$.form.unlockMethod.$dirty) {\n        lockoutDuration = this.form.unlockMethod\n          ? parseInt(this.form.lockoutDuration)\n          : 0;\n      }\n\n      this.$emit('ok', { lockoutThreshold, lockoutDuration });\n      this.closeModal();\n    },\n    onOk(bvModalEvt) {\n      // prevent modal close\n      bvModalEvt.preventDefault();\n      this.handleSubmit();\n    },\n    closeModal() {\n      this.$nextTick(() => {\n        this.$refs.modal.hide();\n      });\n    },\n    resetForm() {\n      // Reset form models\n      this.form.lockoutThreshold = this.settings.lockoutThreshold;\n      this.form.unlockMethod = this.settings.lockoutDuration ? 1 : 0;\n      this.form.lockoutDuration = this.settings.lockoutDuration\n        ? this.settings.lockoutDuration\n        : null;\n      this.v$.$reset(); // clear validations\n    },\n  },\n};\n</script>\n"],"mappings":"AA4HA,OAAOA,cAAa,MAAO,uCAAuC;AAClE,SAASC,YAAW,QAAS,iBAAiB;AAC9C,SAASC,OAAM,QAAS,UAAU;AAElC,SACEC,QAAQ,EACRC,UAAU,EACVC,QAAQ,EACRC,QAAQ,QACH,uBAAuB;AAE9B,eAAe;EACbC,MAAM,EAAE,CAACP,cAAc,CAAC;EACxBQ,KAAK,EAAE;IACLC,QAAQ,EAAE;MACRC,IAAI,EAAEC,MAAM;MACZR,QAAQ,EAAE;IACZ;EACF,CAAC;EACDS,KAAKA,CAAA,EAAG;IACN,OAAO;MACLC,EAAE,EAAEZ,YAAY,CAAC;IACnB,CAAC;EACH,CAAC;EACDa,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,EAAE,EAAEb,OAAO,CAAC,CAAC,CAACc,CAAC;MACfC,IAAI,EAAE;QACJC,gBAAgB,EAAE,CAAC;QACnBC,YAAY,EAAE,CAAC;QACfC,eAAe,EAAE;MACnB;IACF,CAAC;EACH,CAAC;EACDC,KAAK,EAAE;IACLZ,QAAQ,EAAE,SAAAA,CAAU;MAAES,gBAAgB;MAAEE;IAAgB,CAAC,EAAE;MACzD,IAAI,CAACH,IAAI,CAACC,gBAAe,GAAIA,gBAAgB;MAC7C,IAAI,CAACD,IAAI,CAACE,YAAW,GAAIC,eAAc,GAAI,IAAI,CAAC;MAChD,IAAI,CAACH,IAAI,CAACG,eAAc,GAAIA,eAAc,GAAIA,eAAc,GAAI,IAAI;IACtE;EACF,CAAC;EACDE,WAAW,EAAE;IACXL,IAAI,EAAE;MACJC,gBAAgB,EAAE;QAChBb,QAAQ,EAAEA,QAAQ,CAAC,CAAC,CAAC;QACrBC,QAAQ,EAAEA,QAAQ,CAAC,KAAK,CAAC;QACzBH;MACF,CAAC;MACDgB,YAAY,EAAE;QAAEhB;MAAS,CAAC;MAC1BiB,eAAe,EAAE;QACff,QAAQ,EAAE,SAAAA,CAAUkB,KAAK,EAAE;UACzB,OAAO,IAAI,CAACN,IAAI,CAACE,YAAW,KAAM,KAAKI,KAAI,GAAI,CAAC;QAClD,CAAC;QACDpB,QAAQ,EAAEC,UAAU,CAAC,YAAY;UAC/B,OAAO,IAAI,CAACa,IAAI,CAACE,YAAW,KAAM,CAAC;QACrC,CAAC;MACH;IACF;EACF,CAAC;EACDK,OAAO,EAAE;IACPC,YAAYA,CAAA,EAAG;MACb,IAAI,CAACZ,EAAE,CAACa,MAAM,CAAC,CAAC;MAChB,IAAI,IAAI,CAACb,EAAE,CAACc,QAAQ,EAAE;MAEtB,IAAIT,gBAAgB;MACpB,IAAIE,eAAe;MACnB,IAAI,IAAI,CAACP,EAAE,CAACI,IAAI,CAACC,gBAAgB,CAACU,MAAM,EAAE;QACxCV,gBAAe,GAAI,IAAI,CAACD,IAAI,CAACC,gBAAgB;MAC/C;MACA,IAAI,IAAI,CAACL,EAAE,CAACI,IAAI,CAACE,YAAY,CAACS,MAAM,EAAE;QACpCR,eAAc,GAAI,IAAI,CAACH,IAAI,CAACE,YAAW,GACnCU,QAAQ,CAAC,IAAI,CAACZ,IAAI,CAACG,eAAe,IAClC,CAAC;MACP;MAEA,IAAI,CAACU,KAAK,CAAC,IAAI,EAAE;QAAEZ,gBAAgB;QAAEE;MAAgB,CAAC,CAAC;MACvD,IAAI,CAACW,UAAU,CAAC,CAAC;IACnB,CAAC;IACDC,IAAIA,CAACC,UAAU,EAAE;MACf;MACAA,UAAU,CAACC,cAAc,CAAC,CAAC;MAC3B,IAAI,CAACT,YAAY,CAAC,CAAC;IACrB,CAAC;IACDM,UAAUA,CAAA,EAAG;MACX,IAAI,CAACI,SAAS,CAAC,MAAM;QACnB,IAAI,CAACC,KAAK,CAACC,KAAK,CAACC,IAAI,CAAC,CAAC;MACzB,CAAC,CAAC;IACJ,CAAC;IACDC,SAASA,CAAA,EAAG;MACV;MACA,IAAI,CAACtB,IAAI,CAACC,gBAAe,GAAI,IAAI,CAACT,QAAQ,CAACS,gBAAgB;MAC3D,IAAI,CAACD,IAAI,CAACE,YAAW,GAAI,IAAI,CAACV,QAAQ,CAACW,eAAc,GAAI,IAAI,CAAC;MAC9D,IAAI,CAACH,IAAI,CAACG,eAAc,GAAI,IAAI,CAACX,QAAQ,CAACW,eAAc,GACpD,IAAI,CAACX,QAAQ,CAACW,eAAc,GAC5B,IAAI;MACR,IAAI,CAACP,EAAE,CAAC2B,MAAM,CAAC,CAAC,EAAE;IACpB;EACF;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}