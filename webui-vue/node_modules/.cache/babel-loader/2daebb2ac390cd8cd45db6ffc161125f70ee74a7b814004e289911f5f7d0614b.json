{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, withModifiers as _withModifiers, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"form-background p-3\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_b_form_select = _resolveComponent(\"b-form-select\");\n  const _component_b_form_group = _resolveComponent(\"b-form-group\");\n  const _component_b_form_checkbox = _resolveComponent(\"b-form-checkbox\");\n  const _component_b_form_text = _resolveComponent(\"b-form-text\");\n  const _component_b_button = _resolveComponent(\"b-button\");\n  const _component_b_form = _resolveComponent(\"b-form\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createVNode(_component_b_form, {\n    novalidate: \"\",\n    onSubmit: _withModifiers($options.handleSubmit, [\"prevent\"])\n  }, {\n    default: _withCtx(() => [_createVNode(_component_b_form_group, {\n      label: $data.$t('pageServerPowerOperations.bootSettings.bootSettingsOverride'),\n      \"label-for\": \"boot-option\",\n      class: \"mb-3\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_b_form_select, {\n        id: \"boot-option\",\n        modelValue: $data.form.bootOption,\n        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.form.bootOption = $event),\n        disabled: _ctx.bootSourceOptions.length === 0,\n        options: _ctx.bootSourceOptions,\n        onChange: $options.onChangeSelect\n      }, null, 8 /* PROPS */, [\"modelValue\", \"disabled\", \"options\", \"onChange\"])], undefined, true),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"label\"]), _createVNode(_component_b_form_checkbox, {\n      modelValue: $data.form.oneTimeBoot,\n      \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $data.form.oneTimeBoot = $event),\n      class: \"mb-4\",\n      disabled: $data.form.bootOption === 'None',\n      onChange: _cache[2] || (_cache[2] = $event => $setup.v$.form.oneTimeBoot.$touch())\n    }, {\n      default: _withCtx(() => [_createTextVNode(_toDisplayString($data.$t('pageServerPowerOperations.bootSettings.enableOneTimeBoot')), 1 /* TEXT */)], undefined, true),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"modelValue\", \"disabled\"]), _createVNode(_component_b_form_group, {\n      label: $data.$t('pageServerPowerOperations.bootSettings.tpmRequiredPolicy')\n    }, {\n      default: _withCtx(() => [_createVNode(_component_b_form_text, {\n        id: \"tpm-required-policy-help-block\"\n      }, {\n        default: _withCtx(() => [_createTextVNode(_toDisplayString($data.$t('pageServerPowerOperations.bootSettings.tpmRequiredPolicyHelper')), 1 /* TEXT */)], undefined, true),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_b_form_checkbox, {\n        id: \"tpm-required-policy\",\n        modelValue: $data.form.tpmPolicyOn,\n        \"onUpdate:modelValue\": _cache[3] || (_cache[3] = $event => $data.form.tpmPolicyOn = $event),\n        \"aria-describedby\": \"tpm-required-policy-help-block\",\n        onChange: _cache[4] || (_cache[4] = $event => $setup.v$.form.tpmPolicyOn.$touch())\n      }, {\n        default: _withCtx(() => [_createTextVNode(_toDisplayString($data.$t('global.status.enabled')), 1 /* TEXT */)], undefined, true),\n        _: 1 /* STABLE */\n      }, 8 /* PROPS */, [\"modelValue\"])], undefined, true),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"label\"]), _createVNode(_component_b_button, {\n      variant: \"primary\",\n      type: \"submit\",\n      class: \"mb-3\"\n    }, {\n      default: _withCtx(() => [_createTextVNode(_toDisplayString($data.$t('global.action.save')), 1 /* TEXT */)], undefined, true),\n      _: 1 /* STABLE */\n    })], undefined, true),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"onSubmit\"])]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createVNode","_component_b_form","novalidate","onSubmit","_withModifiers","$options","handleSubmit","default","_withCtx","_component_b_form_group","label","$data","$t","_component_b_form_select","id","modelValue","form","bootOption","_cache","$event","disabled","_ctx","bootSourceOptions","length","options","onChange","onChangeSelect","_","_component_b_form_checkbox","oneTimeBoot","$setup","v$","$touch","_createTextVNode","_toDisplayString","_component_b_form_text","tpmPolicyOn","_component_b_button","variant","type"],"sources":["/home/zenchenko/openbmc/build/evb-ast2500/workspace/sources/webui-vue/src/views/Operations/ServerPowerOperations/BootSettings.vue"],"sourcesContent":["<template>\n  <div class=\"form-background p-3\">\n    <b-form novalidate @submit.prevent=\"handleSubmit\">\n      <b-form-group\n        :label=\"\n          $t('pageServerPowerOperations.bootSettings.bootSettingsOverride')\n        \"\n        label-for=\"boot-option\"\n        class=\"mb-3\"\n      >\n        <b-form-select\n          id=\"boot-option\"\n          v-model=\"form.bootOption\"\n          :disabled=\"bootSourceOptions.length === 0\"\n          :options=\"bootSourceOptions\"\n          @change=\"onChangeSelect\"\n        >\n        </b-form-select>\n      </b-form-group>\n      <b-form-checkbox\n        v-model=\"form.oneTimeBoot\"\n        class=\"mb-4\"\n        :disabled=\"form.bootOption === 'None'\"\n        @change=\"v$.form.oneTimeBoot.$touch()\"\n      >\n        {{ $t('pageServerPowerOperations.bootSettings.enableOneTimeBoot') }}\n      </b-form-checkbox>\n      <b-form-group\n        :label=\"$t('pageServerPowerOperations.bootSettings.tpmRequiredPolicy')\"\n      >\n        <b-form-text id=\"tpm-required-policy-help-block\">\n          {{\n            $t('pageServerPowerOperations.bootSettings.tpmRequiredPolicyHelper')\n          }}\n        </b-form-text>\n        <b-form-checkbox\n          id=\"tpm-required-policy\"\n          v-model=\"form.tpmPolicyOn\"\n          aria-describedby=\"tpm-required-policy-help-block\"\n          @change=\"v$.form.tpmPolicyOn.$touch()\"\n        >\n          {{ $t('global.status.enabled') }}\n        </b-form-checkbox>\n      </b-form-group>\n      <b-button variant=\"primary\" type=\"submit\" class=\"mb-3\">\n        {{ $t('global.action.save') }}\n      </b-button>\n    </b-form>\n  </div>\n</template>\n\n<script>\nimport { mapState } from 'vuex';\nimport BVToastMixin from '@/components/Mixins/BVToastMixin';\nimport LoadingBarMixin from '@/components/Mixins/LoadingBarMixin';\nimport { useI18n } from 'vue-i18n';\nimport { useVuelidate } from '@vuelidate/core';\n\nexport default {\n  name: 'BootSettings',\n  mixins: [BVToastMixin, LoadingBarMixin],\n  setup() {\n    return {\n      v$: useVuelidate(),\n    };\n  },\n  data() {\n    return {\n      $t: useI18n().t,\n      form: {\n        bootOption: this.$store.getters['serverBootSettings/bootSource'],\n        oneTimeBoot: this.$store.getters['serverBootSettings/overrideEnabled'],\n        tpmPolicyOn: this.$store.getters['serverBootSettings/tpmEnabled'],\n      },\n    };\n  },\n  computed: {\n    ...mapState('serverBootSettings', [\n      'bootSourceOptions',\n      'bootSource',\n      'overrideEnabled',\n      'tpmEnabled',\n    ]),\n  },\n  watch: {\n    bootSource: function (value) {\n      this.form.bootOption = value;\n    },\n    overrideEnabled: function (value) {\n      this.form.oneTimeBoot = value;\n    },\n    tpmEnabled: function (value) {\n      this.form.tpmPolicyOn = value;\n    },\n  },\n  validations: {\n    // Empty validations to leverage vuelidate form states\n    // to check for changed values\n    form: {\n      bootOption: {},\n      oneTimeBoot: {},\n      tpmPolicyOn: {},\n    },\n  },\n  created() {\n    this.$store\n      .dispatch('serverBootSettings/getTpmPolicy')\n      .finally(() =>\n        this.$root.$emit('server-power-operations-boot-settings-complete'),\n      );\n  },\n  methods: {\n    handleSubmit() {\n      this.startLoader();\n      const tpmPolicyChanged = this.v$.form.tpmPolicyOn.$dirty;\n      let settings;\n      let bootSource = this.form.bootOption;\n      let overrideEnabled = this.form.oneTimeBoot;\n      let tpmEnabled = null;\n\n      if (tpmPolicyChanged) tpmEnabled = this.form.tpmPolicyOn;\n      settings = { bootSource, overrideEnabled, tpmEnabled };\n\n      this.$store\n        .dispatch('serverBootSettings/saveSettings', settings)\n        .then((message) => this.successToast(message))\n        .catch(({ message }) => this.errorToast(message))\n        .finally(() => {\n          this.v$.form.$reset();\n          this.endLoader();\n        });\n    },\n    onChangeSelect(selectedOption) {\n      this.v$.form.bootOption.$touch();\n      // Disable one time boot if selected boot option is 'None'\n      if (selectedOption === 'None') this.form.oneTimeBoot = false;\n    },\n  },\n};\n</script>\n"],"mappings":";;EACOA,KAAK,EAAC;AAAqB;;;;;;;;uBAAhCC,mBAAA,CA+CM,OA/CNC,UA+CM,GA9CJC,YAAA,CA6CSC,iBAAA;IA7CDC,UAAU,EAAV,EAAU;IAAEC,QAAM,EAF9BC,cAAA,CAEwCC,QAAA,CAAAC,YAAY;;IAFpDC,OAAA,EAAAC,QAAA,CAGM,MAee,CAffR,YAAA,CAeeS,uBAAA;MAdZC,KAAK,EAAaC,KAAA,CAAAC,EAAE;MAGrB,WAAS,EAAC,aAAa;MACvBf,KAAK,EAAC;;MARdU,OAAA,EAAAC,QAAA,CAUQ,MAOgB,CAPhBR,YAAA,CAOgBa,wBAAA;QANdC,EAAE,EAAC,aAAa;QAX1BC,UAAA,EAYmBJ,KAAA,CAAAK,IAAI,CAACC,UAAU;QAZlC,uBAAAC,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAYmBR,KAAA,CAAAK,IAAI,CAACC,UAAU,GAAAE,MAAA;QACvBC,QAAQ,EAAEC,IAAA,CAAAC,iBAAiB,CAACC,MAAM;QAClCC,OAAO,EAAEH,IAAA,CAAAC,iBAAiB;QAC1BG,QAAM,EAAEpB,QAAA,CAAAqB;;MAfnBC,CAAA;kCAmBM3B,YAAA,CAOkB4B,0BAAA;MA1BxBb,UAAA,EAoBiBJ,KAAA,CAAAK,IAAI,CAACa,WAAW;MApBjC,uBAAAX,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAoBiBR,KAAA,CAAAK,IAAI,CAACa,WAAW,GAAAV,MAAA;MACzBtB,KAAK,EAAC,MAAM;MACXuB,QAAQ,EAAET,KAAA,CAAAK,IAAI,CAACC,UAAU;MACzBQ,QAAM,EAAAP,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAAEW,MAAA,CAAAC,EAAE,CAACf,IAAI,CAACa,WAAW,CAACG,MAAM;;MAvB3CzB,OAAA,EAAAC,QAAA,CAyBQ,MAAoE,CAzB5EyB,gBAAA,CAAAC,gBAAA,CAyBWvB,KAAA,CAAAC,EAAE,6E;MAzBbe,CAAA;mDA2BM3B,YAAA,CAgBeS,uBAAA;MAfZC,KAAK,EAAEC,KAAA,CAAAC,EAAE;;MA5BlBL,OAAA,EAAAC,QAAA,CA8BQ,MAIc,CAJdR,YAAA,CAIcmC,sBAAA;QAJDrB,EAAE,EAAC;MAAgC;QA9BxDP,OAAA,EAAAC,QAAA,CA+BU,MAEE,CAjCZyB,gBAAA,CAAAC,gBAAA,CAgCYvB,KAAA,CAAAC,EAAE,mF;QAhCde,CAAA;UAmCQ3B,YAAA,CAOkB4B,0BAAA;QANhBd,EAAE,EAAC,qBAAqB;QApClCC,UAAA,EAqCmBJ,KAAA,CAAAK,IAAI,CAACoB,WAAW;QArCnC,uBAAAlB,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAqCmBR,KAAA,CAAAK,IAAI,CAACoB,WAAW,GAAAjB,MAAA;QACzB,kBAAgB,EAAC,gCAAgC;QAChDM,QAAM,EAAAP,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAAEW,MAAA,CAAAC,EAAE,CAACf,IAAI,CAACoB,WAAW,CAACJ,MAAM;;QAvC7CzB,OAAA,EAAAC,QAAA,CAyCU,MAAiC,CAzC3CyB,gBAAA,CAAAC,gBAAA,CAyCavB,KAAA,CAAAC,EAAE,0C;QAzCfe,CAAA;;MAAAA,CAAA;kCA4CM3B,YAAA,CAEWqC,mBAAA;MAFDC,OAAO,EAAC,SAAS;MAACC,IAAI,EAAC,QAAQ;MAAC1C,KAAK,EAAC;;MA5CtDU,OAAA,EAAAC,QAAA,CA6CQ,MAA8B,CA7CtCyB,gBAAA,CAAAC,gBAAA,CA6CWvB,KAAA,CAAAC,EAAE,uC;MA7Cbe,CAAA;;IAAAA,CAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}